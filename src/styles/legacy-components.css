/**
 * Legacy Components
 *
 * Contains legacy/existing components that were built before M3 integration:
 * - Skip-to-main link
 * - Training card (with gradients and shadows)
 * - Custom Leaflet marker
 * - Skeleton loading
 * - Button variants (btn-primary, btn-secondary)
 * - Badge
 * - Global actions toolbar
 * - Notification toast
 */

@layer components {
  /* Skip to Main Link (Enhanced) */
  .skip-to-main {
    @apply sr-only focus:not-sr-only;
    @apply fixed top-4 left-4 z-[9999];
    @apply px-6 py-3;
    @apply bg-primary-600 text-white font-semibold;
    @apply rounded-lg shadow-xl;
    @apply transition-all duration-fast;
    @apply focus:scale-105;
  }

  /* Training Card (Enhanced with Gradient + Two-Layer Shadows) */
  .training-card {
    @apply relative rounded-2xl p-5;
    @apply border border-slate-200;
    @apply transition-all duration-normal;

    /* Gradient Background (subtle depth effect) */
    background: linear-gradient(145deg, oklch(0.97 0.01 240), oklch(0.95 0.01 240));

    /* Two-Layer Shadow - Level 1 (Resting State) */
    box-shadow: var(--shadow-card-rest);

    /* Performance Hints */
    will-change: transform, box-shadow;
    contain: layout style paint;

    /* Prevent CLS: Reserve space for content */
    min-height: 180px;

    /* Initial State */
    opacity: 0;
    transform: translateY(10px);
  }

  .training-card.animate-fade-in {
    animation: fadeIn var(--duration-normal) var(--ease-smooth) forwards;
  }

  /* Modern Hover (with :has selector) - Level 2 Shadow */
  .training-card:hover {
    @apply border-primary-300;
    box-shadow: var(--shadow-card-hover);
    transform: translateY(-2px);

    /* Slightly brighter gradient on hover */
    background: linear-gradient(145deg, oklch(0.98 0.01 240), oklch(0.96 0.01 240));
  }

  /* Active State - Level 3 Shadow */
  .training-card:active {
    transform: translateY(0);
    box-shadow: var(--shadow-card-active);
    transition-duration: var(--duration-instant);
  }

  /* Favorite Indicator */
  .training-card:has(.favorite-active) {
    @apply ring-2 ring-yellow-400 ring-offset-2;
  }

  /* Custom Leaflet Marker (Optimized) */
  .custom-marker {
    @apply flex items-center justify-center;
    @apply w-10 h-10 font-bold rounded-full;
    @apply bg-primary-500 text-white;
    border: 3px solid white;
    box-shadow: 0 8px 16px 0 oklch(0 0 0 / 0.15), 0 4px 8px 0 oklch(0 0 0 / 0.1);
    will-change: transform;
  }

  .custom-marker:hover {
    transform: scale(1.15);
    transition: transform var(--duration-fast) var(--ease-spring);
  }

  /* Skeleton Loading (Modern) */
  .skeleton {
    @apply relative overflow-hidden bg-slate-200;

    /* Animated Gradient */
    background: linear-gradient(
      90deg,
      oklch(0.94 0.01 240) 0%,
      oklch(0.96 0.01 240) 50%,
      oklch(0.94 0.01 240) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s ease-in-out infinite;
  }

  /* Button Variants (Enhanced with Gradients + Two-Layer Shadows) */
  .btn-primary {
    @apply px-4 py-2 text-white rounded-lg;
    @apply font-medium transition-all duration-fast;
    @apply focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2;

    /* Gradient Background */
    background: linear-gradient(135deg, oklch(0.47 0.15 240), oklch(0.38 0.13 240));

    /* Two-Layer Shadow - Button Rest */
    box-shadow: var(--shadow-button-rest);
  }

  .btn-primary:hover {
    /* Brighter gradient on hover */
    background: linear-gradient(135deg, oklch(0.50 0.15 240), oklch(0.42 0.13 240));
    box-shadow: var(--shadow-button-hover);
    transform: translateY(-1px);
  }

  .btn-primary:active {
    /* Pressed state with inset shadow */
    box-shadow: var(--shadow-button-pressed);
    transform: translateY(0);
  }

  .btn-secondary {
    @apply px-4 py-2 text-slate-700 rounded-lg;
    @apply font-medium transition-all duration-fast;

    /* Subtle gradient for secondary button */
    background: linear-gradient(145deg, oklch(0.97 0.01 240), oklch(0.95 0.01 240));
    box-shadow: var(--shadow-button-rest);
  }

  .btn-secondary:hover {
    background: linear-gradient(145deg, oklch(0.98 0.01 240), oklch(0.96 0.01 240));
    box-shadow: var(--shadow-button-hover);
    transform: translateY(-1px);
  }

  .btn-secondary:active {
    box-shadow: var(--shadow-button-pressed);
    transform: translateY(0);
  }

  /* Badge */
  .badge {
    @apply inline-flex items-center gap-1 px-2 py-1;
    @apply text-xs font-medium rounded-md;
    @apply transition-colors duration-fast;
  }

  /* Global Actions Toolbar (New) */
  .global-actions-toolbar {
    @apply sticky top-0 z-40;
    @apply bg-white/95 backdrop-blur-md;
    @apply border-b border-slate-200 shadow-sm;

    /* Performance */
    will-change: transform;
    contain: layout style;
  }

  /* Notification Toast */
  .notification-toast {
    @apply fixed top-4 right-4 z-50;
    @apply max-w-sm p-4 bg-white rounded-xl;
    @apply shadow-modal border border-slate-200;
    animation: slideInRight var(--duration-normal) var(--ease-spring);
  }

  /* ==================== DARK MODE SUPPORT FOR LEGACY COMPONENTS ==================== */

  /* Training Card Dark Mode */
  :root[data-theme="dark"] .training-card {
    background: linear-gradient(145deg, var(--md-sys-color-surface-container-high), var(--md-sys-color-surface-container));
    border-color: var(--md-sys-color-outline-variant);
  }

  :root[data-theme="dark"] .training-card:hover {
    background: linear-gradient(145deg, var(--md-sys-color-surface-container-highest), var(--md-sys-color-surface-container-high));
    border-color: var(--md-sys-color-outline);
  }

  /* Button Dark Mode */
  :root[data-theme="dark"] .btn-secondary {
    background: linear-gradient(145deg, var(--md-sys-color-surface-container), var(--md-sys-color-surface-dim));
    color: var(--md-sys-color-on-surface);
  }

  :root[data-theme="dark"] .btn-secondary:hover {
    background: linear-gradient(145deg, var(--md-sys-color-surface-container-high), var(--md-sys-color-surface-container));
  }

  /* Global Actions Toolbar Dark Mode */
  :root[data-theme="dark"] .global-actions-toolbar {
    background-color: var(--md-sys-color-surface-container-highest);
    border-color: var(--md-sys-color-outline-variant);
  }

  /* Skeleton Dark Mode */
  :root[data-theme="dark"] .skeleton {
    background: linear-gradient(
      90deg,
      var(--md-sys-color-surface-container) 0%,
      var(--md-sys-color-surface-container-high) 50%,
      var(--md-sys-color-surface-container) 100%
    );
    background-size: 200% 100%;
  }

  /* Notification Toast Dark Mode */
  :root[data-theme="dark"] .notification-toast {
    background-color: var(--md-sys-color-surface-container-high);
    border-color: var(--md-sys-color-outline-variant);
    color: var(--md-sys-color-on-surface);
  }
}
